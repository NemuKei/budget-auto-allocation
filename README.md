
# 日別予算自動生成ツール

このプロジェクトは、ホテルの月次予算を日別に自動按分するためのツールです。  
宿泊売上、室数、人数、朝食などの項目を、曜日・祝日・連休・過去実績をもとに分配し、実用性の高い日別予算データを生成します。

---

## 📁 フォルダ構成

```
project_root/
├── input/            # 入力CSVファイルを格納（以下2ファイルが必要）
│   ├── 月次予算.csv       # 年・月単位の予算情報
│   └── 日別実績.csv       # 過去の宿泊実績（日付、宿泊売上、室数、人数 など）
├── output/           # 日別予算の出力先（Excel形式）
├── main.py           # 本体スクリプト
└── README.md         # このファイル
```

---

## ✅ 主な機能

- Tkinter GUI による簡単な入力（年度、室数キャパ、朝食単価、重み設定）
- 日別に次の指標を自動按分：
  - 宿泊売上
  - 室数
  - 人数
  - 朝食売上（喫食数 × 単価）
  - その他売上（均等配分）
- 曜日・祝日・連休・祝前日を加味した配分（`jpholiday`ライブラリ活用）
  - **祝前日は土曜日相当の配分とする**
  - **3連休以上は初日に1.1倍・中日は0.9倍の係数調整**
  - **大型連休（GW等）も同様ロジックで調整**
- 宿泊売上・室数・人数に対して過去実績に基づく上下限を適用
  - 上限：過去最高値 × 1.05
  - 下限：前年同月および直近3ヶ月の最小値 × 0.9（稼働率は -5% を下限）
- 指標整合性を維持するための自動チェック
  - ADR（客室単価）
  - DOR（1室あたりの人数）
  - OCC（稼働率）
  - RevPAR（販売可能客室あたり収益）

---

## 🔧 使用方法

1. 必要ライブラリをインストール：

```bash
pip install pandas openpyxl jpholiday
```

2. 入力ファイルを `input/` に配置：

- `月次予算.csv`
- `日別実績.csv`

3. GUI を起動：

```bash
python main.py
```

4. 年度・キャパ・単価・重みを設定し、「実行」ボタンをクリック

5. 出力ファイルが `output/日別予算_XXXX.xlsx` に保存されます

---

## 📌 出力仕様

- 各月ごとにシート出力（例: `2025-06`, `2025-07` ...）
- 日付は `yyyy/m/d` 形式で表示
- `曜日` 列：日〜土（日本語）
- `祝日` 列：祝日名（なければ空欄）
- `ADR`, `DOR`, `OCC`, `RevPAR` の指標列を自動付与

---

## 💡 今後の改善候補

- GUIからファイル選択や実績分析を自動化
- 異常値の自動検出と修正提案
- 喫食率の月別推定や朝食単価の変動対応
- API連携によるクラウド運用

---

## ライセンス

MIT License

---

## 開発者

- 中村 圭一（@NemuKei）
- GPT-4 / OpenAI Codex による開発支援
